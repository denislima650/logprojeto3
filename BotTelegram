import telebot, datetime, os, urllib.request
from selenium.webdriver.common.by import By
from selenium import webdriver
root_directory = (fr'C:\Log\OneDrive - GALAPAGOS CAPITAL\5.MIDDLE\Imagens\mapas_stormvista')
data = datetime.datetime.now()
CHAVE_API = "5971673742:AAEJyuVS3k2KDwHnsutcZDbTwvwB5dhixsc" #chave de criação do BOT do telegram via BotFather
bot = telebot.TeleBot(CHAVE_API)
browser = webdriver.Firefox()
browser.get(f'https://www.stormvistawxmodels.com/')
@bot.message_handler(commands=["opcao1"])
def opcao1(mensagem):
    try:
        busca_elemento = browser.find_element(By.ID, 'edit-submite')
        if busca_elemento:
            bot.send_message(mensagem.chat.id, f"O BOTÃO APARECE")
            print(mensagem)
        else:
            bot.send_message(mensagem.chat.id, f"BOTÃO INDISPONÍVEL")
    except Exception as erro:
        print(erro)
        bot.send_message(mensagem.chat.id, "BOTÃO INDISPONÍVEL")
        print(mensagem)

@bot.message_handler(commands=["opcao2"])
def opcao2(mensagem):
    if os.path.isdir(fr'{root_directory}\gfs-ens-suite\{data}'):
        bot.send_message(mensagem.chat.id, f"O MAPA DE HOJE JÁ ESTÁ DISPONÍVEL NO DIRETÓRIO {root_directory}")
    else:
        bot.send_message(mensagem.chat.id, f"O MAPA DE HOJE NÃO ESTÁ DISPONÍVEL")
@bot.message_handler(commands=["opcao3"])
def opcao3(mensagem):
    if os.path.isdir(fr'{root_directory}\ecmwf-suite\{data}'):
        bot.send_message(mensagem.chat.id, f"O MAPA DE HOJE JÁ ESTÁ DISPONÍVEL NO DIRETÓRIO {root_directory}")
    else:
        bot.send_message(mensagem.chat.id, f"O MAPA DE HOJE NÃO ESTÁ DISPONÍVEL")




def verificar(mensagem):
    return True

@bot.message_handler(func=verificar)
def responder(mensagem):
    texto = """
    Escolha uma opção para continuar (Clique no item):
     /opcao1 procurar-botao
     /opcao2 gfs-ens-suite
     /opcao3 ecmwf-suite
Responder qualquer outra coisa não vai funcionar, clique em uma das opções"""
    bot.reply_to(mensagem, texto)

bot.polling()
