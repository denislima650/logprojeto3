import telebot, datetime, os, urllib.request
from selenium.webdriver.common.by import By
from selenium import webdriver
data = datetime.datetime.today().strftime("%Y%m%d")
CHAVE_API = "5971673742:AAEJyuVS3k2KDwHnsutcZDbTwvwB5dhixsc" #chave de criação do BOT do telegram via BotFather
bot = telebot.TeleBot(CHAVE_API)
@bot.message_handler(commands=["opcao6"])
def opcao6():
    import operadores_Web_2 as opw
    mapas123 = opw.operador_StormVista('geck')
    mapas123.cfsweekly00z()

@bot.message_handler(commands=["opcao1"])
def opcao1():
    import operadores_Web_2 as opw
    mapas123 = opw.operador_StormVista('geck')
    mapas = ['120', '240', '360']
    modelos = ['gfs-suite', 'gfs-ens-suite', 'ecmwf-suite', 'ecmwf-eps-suite', 'cmc-ens-suite']
    horario = ['00z']
    mapas123.mapaesp(modelos, horario, mapas, True)

def verificar(mensagem):
    return True

@bot.message_handler(func=verificar)
def responder(mensagem):
    texto = """
    Escolha uma opção para continuar (Clique no item):
     /opcao1 gfs-suite
Responder qualquer outra coisa não vai funcionar, clique em uma das opções"""
    bot.reply_to(mensagem, texto)

def e():
    #chatid = 5942965901 #Denis
    #chatid = -883839244 #Teste
    chatid = -865724017  #Mapas_StormVista
    modelos_stormvista = ['gfs-suite', 'gfs-ens-suite', 'ecmwf-suite', 'ecmwf-eps-suite', 'cmc-ens-suite']
    for modelo in modelos_stormvista:
        for c in range(120, 480, 120):
            data = datetime.datetime.today().strftime("%Y%m%d")
            chatid = -865724017
            try:
                documento = open(fr'C:\Log\OneDrive - GALAPAGOS CAPITAL\5.MIDDLE\Imagens\mapas_stormvista\{modelo}\{data}\{data}_{modelo}_00z_{c}.png', 'rb')
                bot.send_document(chatid, documento)
            except:
                pass
    for c in range(1, 5):
        data = datetime.datetime.today().strftime("%Y%m%d")
        documento = open(fr'C:\Log\OneDrive - GALAPAGOS CAPITAL\5.MIDDLE\Imagens\mapas_stormvista\cfs-weekly\{data}\{data}_cfs-weekly_00z_{c}_{contador}.png', 'rb')
        bot.send_document(chatid, documento)
e()
bot.polling()
